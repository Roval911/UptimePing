
## Общая структура каждого сервиса (Clean Architecture)

```
service-name/
├── cmd/
│   └── server/
│       └── main.go
├── internal/
│   ├── domain/
│   │   ├── models.go
│   │   └── errors.go
│   ├── repository/
│   │   ├── interfaces.go
│   │   ├── postgres/
│   │   │   ├── base_repository.go
│   │   │   └── [entity]_repository.go
│   │   └── redis/
│   │       └── [entity]_repository.go
│   ├── service/
│   │   ├── interfaces.go
│   │   └── [service_name]_service.go
│   ├── handler/
│   │   ├── grpc/
│   │   │   ├── handler.go
│   │   │   └── server.go
│   │   └── http/
│   │       ├── handler.go
│   │       └── router.go
│   ├── config/
│   │   └── config.go
│   ├── middleware/
│   │   ├── auth.go
│   │   ├── logging.go
│   │   ├── metrics.go
│   │   └── recovery.go
│   ├── client/
│   │   └── [service]_client.go
│   ├── consumer/
│   │   └── rabbitmq/
│   │       ├── consumer.go
│   │       ├── worker_pool.go
│   │       └── dead_letter.go
│   ├── producer/
│   │   └── rabbitmq/
│   │       ├── producer.go
│   │       └── dead_letter.go
│   ├── worker/
│   │   ├── pool.go
│   │   └── [worker_name].go
│   └── pkg/
│       ├── jwt/
│       │   └── jwt.go
│       └── [util_name]/
│           └── [util].go
├── api/
│   └── proto/
│       └── [service]/
│           └── v1/
│               ├── [service].proto
│               └── [service].pb.go
├── migrations/
│   ├── [version]_[description].sql
│   └── seed/
│       └── [version]_seed_[description].sql
├── deployments/
│   ├── docker/
│   │   └── Dockerfile
│   ├── k8s/
│   │   ├── deployment.yaml
│   │   ├── service.yaml
│   │   ├── configmap.yaml
│   │   └── ingress.yaml
│   └── docker-compose/
│       └── docker-compose.yml
├── tests/
│   ├── unit/
│   │   ├── service_test.go
│   │   └── repository_test.go
│   ├── integration/
│   │   ├── integration_test.go
│   │   └── setup_test.go
│   └── e2e/
│       └── e2e_test.go
├── .env.example
├── .gitignore
├── go.mod
├── go.sum
├── Makefile
├── README.md
└── CHANGELOG.md
```

## 1. API Gateway Service

```
api-gateway/
├── cmd/server/main.go
├── internal/
│   ├── domain/
│   │   └── models.go
│   ├── handler/
│   │   └── http/
│   │       ├── handler.go
│   │       ├── auth_handler.go
│   │       ├── config_handler.go
│   │       ├── scheduler_handler.go
│   │       ├── forge_handler.go
│   │       ├── incident_handler.go
│   │       ├── health_handler.go
│   │       └── metrics_handler.go
│   ├── middleware/
│   │   ├── auth.go
│   │   ├── cors.go
│   │   ├── logging.go
│   │   ├── rate_limit.go
│   │   ├── recovery.go
│   │   ├── metrics.go
│   │   └── tenant.go
│   ├── client/
│   │   ├── auth_client.go
│   │   ├── config_client.go
│   │   ├── scheduler_client.go
│   │   ├── core_client.go
│   │   ├── incident_client.go
│   │   ├── notification_client.go
│   │   └── forge_client.go
│   ├── interceptor/
│   │   ├── auth.go
│   │   ├── logging.go
│   │   ├── metrics.go
│   │   ├── retry.go
│   │   ├── circuit_breaker.go
│   │   └── timeout.go
│   ├── config/
│   │   └── config.go
│   ├── router/
│   │   └── router.go
│   ├── loadbalancer/
│   │   ├── balancer.go
│   │   ├── round_robin.go
│   │   ├── least_connections.go
│   │   └── discovery.go
│   ├── cache/
│   │   └── redis_cache.go
│   └── proxy/
│       ├── grpc_proxy.go
│       └── http_proxy.go
├── api/
│   ├── proto/
│   │   └── gateway/
│   │       └── v1/
│   │           └── gateway.proto
│   └── swagger/
│       ├── openapi.yaml
│       └── swagger-ui/
├── deployments/
│   ├── docker/
│   │   └── Dockerfile
│   └── k8s/
│       ├── deployment.yaml
│       ├── service.yaml
│       ├── configmap.yaml
│       ├── ingress.yaml
│       └── hpa.yaml
├── .env.example
├── go.mod
├── go.sum
├── Makefile
└── README.md
```

### Функции в internal/handler/http/

**auth\_handler.go:**
- `Register(c *gin.Context)` - POST /api/v1/auth/register
- `Login(c *gin.Context)` - POST /api/v1/auth/login
- `RefreshToken(c *gin.Context)` - POST /api/v1/auth/refresh
- `Logout(c *gin.Context)` - POST /api/v1/auth/logout
- `CreateAPIKey(c *gin.Context)` - POST /api/v1/auth/api-keys
- `RevokeAPIKey(c *gin.Context)` - DELETE /api/v1/auth/api-keys/:id
- `ListAPIKeys(c *gin.Context)` - GET /api/v1/auth/api-keys
- `GetUserProfile(c *gin.Context)` - GET /api/v1/auth/profile
- `UpdateUserProfile(c *gin.Context)` - PUT /api/v1/auth/profile

**config\_handler.go:**
- `CreateCheck(c *gin.Context)` - POST /api/v1/checks
- `GetCheck(c *gin.Context)` - GET /api/v1/checks/:id
- `UpdateCheck(c *gin.Context)` - PUT /api/v1/checks/:id
- `DeleteCheck(c *gin.Context)` - DELETE /api/v1/checks/:id
- `ListChecks(c *gin.Context)` - GET /api/v1/checks
- `ValidateCheckConfig(c *gin.Context)` - POST /api/v1/checks/validate
- `BulkCreateChecks(c *gin.Context)` - POST /api/v1/checks/bulk
- `ExportChecks(c *gin.Context)` - GET /api/v1/checks/export
- `ImportChecks(c *gin.Context)` - POST /api/v1/checks/import

**scheduler\_handler.go:**
- `ScheduleCheck(c *gin.Context)` - POST /api/v1/schedules
- `UnscheduleCheck(c *gin.Context)` - DELETE /api/v1/schedules/:id
- `GetSchedule(c *gin.Context)` - GET /api/v1/schedules/:id
- `ListSchedules(c *gin.Context)` - GET /api/v1/schedules
- `PauseCheck(c *gin.Context)` - POST /api/v1/schedules/:id/pause
- `ResumeCheck(c *gin.Context)` - POST /api/v1/schedules/:id/resume
- `RunNow(c *gin.Context)` - POST /api/v1/schedules/:id/run-now
- `GetJobHistory(c *gin.Context)` - GET /api/v1/schedules/:id/history

**forge\_handler.go:**
- `ParseProto(c *gin.Context)` - POST /api/v1/forge/parse
- `GenerateConfig(c *gin.Context)` - POST /api/v1/forge/generate
- `GenerateCode(c *gin.Context)` - POST /api/v1/forge/generate-code
- `ValidateProto(c *gin.Context)` - POST /api/v1/forge/validate
- `SaveTemplate(c *gin.Context)` - POST /api/v1/forge/templates
- `GetTemplate(c *gin.Context)` - GET /api/v1/forge/templates/:id
- `ListTemplates(c *gin.Context)` - GET /api/v1/forge/templates
- `DeleteTemplate(c *gin.Context)` - DELETE /api/v1/forge/templates/:id

**incident\_handler.go:**
- `ListIncidents(c *gin.Context)` - GET /api/v1/incidents
- `GetIncident(c *gin.Context)` - GET /api/v1/incidents/:id
- `AcknowledgeIncident(c *gin.Context)` - POST /api/v1/incidents/:id/acknowledge
- `ResolveIncident(c *gin.Context)` - POST /api/v1/incidents/:id/resolve
- `GetIncidentEvents(c *gin.Context)` - GET /api/v1/incidents/:id/events
- `GetOpenIncidents(c *gin.Context)` - GET /api/v1/incidents/open
- `GetIncidentStatistics(c *gin.Context)` - GET /api/v1/incidents/stats

**notification\_handler.go:**
- `RegisterChannel(c *gin.Context)` - POST /api/v1/notifications/channels
- `UnregisterChannel(c *gin.Context)` - DELETE /api/v1/notifications/channels/:id
- `ListChannels(c *gin.Context)` - GET /api/v1/notifications/channels
- `UpdateChannel(c *gin.Context)` - PUT /api/v1/notifications/channels/:id
- `TestNotification(c *gin.Context)` - POST /api/v1/notifications/test
- `CreateTemplate(c *gin.Context)` - POST /api/v1/notifications/templates
- `ListTemplates(c *gin.Context)` - GET /api/v1/notifications/templates
- `UpdateTemplate(c *gin.Context)` - PUT /api/v1/notifications/templates/:id
- `DeleteTemplate(c *gin.Context)` - DELETE /api/v1/notifications/templates/:id

## 2. Auth Service

```
auth-service/
├── cmd/server/main.go
├── internal/
│   ├── domain/
│   │   ├── models.go
│   │   └── errors.go
│   ├── repository/
│   │   ├── interfaces.go
│   │   ├── postgres/
│   │   │   ├── base_repository.go
│   │   │   ├── user_repository.go
│   │   │   ├── tenant_repository.go
│   │   │   └── api_key_repository.go
│   │   └── redis/
│   │       ├── base_repository.go
│   │       └── session_repository.go
│   ├── service/
│   │   ├── interfaces.go
│   │   └── auth_service.go
│   ├── handler/
│   │   └── grpc/
│   │       ├── handler.go
│   │       └── server.go
│   ├── config/
│   │   └── config.go
│   ├── middleware/
│   │   ├── logging.go
│   │   ├── metrics.go
│   │   └── recovery.go
│   ├── pkg/
│   │   ├── jwt/
│   │   │   ├── jwt.go
│   │   │   └── validator.go
│   │   ├── password/
│   │   │   └── password.go
│   │   ├── apikey/
│   │   │   ├── generator.go
│   │   │   └── validator.go
│   │   ├── crypto/
│   │   │   └── crypto.go
│   │   └── ratelimit/
│   │       ├── limiter.go
│   │       └── redis_limiter.go
│   └── worker/
│       └── cleanup_worker.go
├── api/
│   └── proto/
│       └── auth/
│           └── v1/
│               ├── auth.proto
│               └── auth.pb.go
├── migrations/
│   ├── 001_create_users.sql
│   ├── 002_create_tenants.sql
│   ├── 003_create_api_keys.sql
│   ├── 004_create_sessions.sql
│   ├── 005_create_audit_logs.sql
│   └── seed/
│       ├── 001_seed_tenants.sql
│       └── 002_seed_admin_users.sql
├── tests/
│   ├── unit/
│   │   ├── service_test.go
│   │   ├── repository_test.go
│   │   ├── jwt_test.go
│   │   └── password_test.go
│   ├── integration/
│   │   ├── auth_integration_test.go
│   │   └── setup_test.go
│   └── e2e/
│       └── auth_e2e_test.go
└── deployments/
    ├── docker/
    │   └── Dockerfile
    └── k8s/
        ├── deployment.yaml
        ├── service.yaml
        └── configmap.yaml
```

### Функции в internal/service/auth\_service.go

**User Management:**
- `Register(email, password, tenantName string) (*domain.TokenPair, error)`
- `Login(email, password string) (*domain.TokenPair, error)`
- `ValidateToken(token string) (*domain.Claims, error)`
- `RefreshToken(refreshToken string) (*domain.TokenPair, error)`
- `Logout(userID, tokenID string) error`
- `GetUser(userID string) (*domain.User, error)`
- `UpdateUser(userID string, updates map[string]interface{}) error`
- `ChangePassword(userID, oldPassword, newPassword string) error`
- `ResetPassword(email string) error`
- `ConfirmResetPassword(token, newPassword string) error`

**Tenant Management:**
- `CreateTenant(name, slug string) (*domain.Tenant, error)`
- `GetTenant(tenantID string) (*domain.Tenant, error)`
- `UpdateTenant(tenantID string, updates map[string]interface{}) error`
- `DeleteTenant(tenantID string) error`
- `ListTenants(filter *domain.TenantFilter) ([]*domain.Tenant, error)`
- `AddUserToTenant(tenantID, userID, role string) error`
- `RemoveUserFromTenant(tenantID, userID string) error`

**API Key Management:**
- `CreateAPIKey(tenantID, name string, expiresAt *time.Time, permissions []string) (*domain.APIKeyPair, error)`
- `ValidateAPIKey(key, secret string) (*domain.APIKeyClaims, error)`
- `RevokeAPIKey(keyID string) error`
- `ListAPIKeys(tenantID string) ([]*domain.APIKey, error)`
- `GetAPIKey(keyID string) (*domain.APIKey, error)`
- `UpdateAPIKey(keyID string, updates map[string]interface{}) error`

**Session Management:**
- `CreateSession(userID string, deviceInfo map[string]string) (*domain.Session, error)`
- `GetSession(sessionID string) (*domain.Session, error)`
- `RevokeSession(sessionID string) error`
- `ListUserSessions(userID string) ([]*domain.Session, error)`
- `CleanupExpiredSessions() error`

## 3. Core Service (Worker)

```
core-service/
├── cmd/server/main.go
├── internal/
│   ├── domain/
│   │   ├── models.go
│   │   └── errors.go
│   ├── repository/
│   │   ├── interfaces.go
│   │   ├── postgres/
│   │   │   ├── base_repository.go
│   │   │   ├── result_repository.go
│   │   │   ├── task_repository.go
│   │   │   └── execution_repository.go
│   │   └── redis/
│   │       └── cache_repository.go
│   ├── service/
│   │   ├── interfaces.go
│   │   ├── check_service.go
│   │   └── validator/
│   │       ├── validator.go
│   │       ├── http_validator.go
│   │       ├── grpc_validator.go
│   │       ├── graphql_validator.go
│   │       ├── tcp_validator.go
│   │       └── composite_validator.go
│   ├── handler/
│   │   └── grpc/
│   │       ├── handler.go
│   │       └── server.go
│   ├── consumer/
│   │   └── rabbitmq/
│   │       ├── consumer.go
│   │       ├── worker_pool.go
│   │       ├── dead_letter.go
│   │       └── retry_handler.go
│   ├── producer/
│   │   └── rabbitmq/
│   │       ├── producer.go
│   │       └── dead_letter.go
│   ├── config/
│   │   └── config.go
│   ├── checker/
│   │   ├── interface.go
│   │   ├── base_checker.go
│   │   ├── http_checker.go
│   │   ├── grpc_checker.go
│   │   ├── graphql_checker.go
│   │   ├── tcp_checker.go
│   │   ├── udp_checker.go
│   │   ├── dns_checker.go
│   │   └── ssl_checker.go
│   ├── client/
│   │   ├── config_client.go
│   │   └── incident_client.go
│   ├── cache/
│   │   └── redis_cache.go
│   ├── metrics/
│   │   └── metrics.go
│   └── worker/
│       └── batch_worker.go
├── api/
│   └── proto/
│       └── core/
│           └── v1/
│               ├── core.proto
│               └── core.pb.go
├── migrations/
│   ├── 001_create_check_results.sql
│   ├── 002_create_tasks.sql
│   ├── 003_create_executions.sql
│   └── 004_create_check_metrics.sql
├── tests/
│   ├── unit/
│   │   ├── checker_test.go
│   │   ├── service_test.go
│   │   └── validator_test.go
│   ├── integration/
│   │   ├── core_integration_test.go
│   │   └── checker_integration_test.go
│   └── e2e/
│       └── core_e2e_test.go
└── deployments/
    ├── docker/
    │   └── Dockerfile
    └── k8s/
        ├── deployment.yaml
        ├── service.yaml
        └── configmap.yaml
```

### Функции в internal/checker/

**http\_checker.go:**
- `Execute(check *domain.Check) (*domain.CheckResult, error)`
- `validateRequest(config *domain.HTTPConfig) error`
- `makeRequest(config *domain.HTTPConfig) (*http.Response, error)`
- `validateResponse(resp *http.Response, config *domain.HTTPConfig) (*domain.ValidationResult, error)`
- `extractMetrics(resp *http.Response, duration time.Duration) map[string]float64`

**grpc\_checker.go:**
- `Execute(check *domain.Check) (*domain.CheckResult, error)`
- `dialGRPC(target string) (*grpc.ClientConn, error)`
- `invokeMethod(conn *grpc.ClientConn, method string, request []byte) ([]byte, error)`
- `validateGRPCResponse(response []byte, config *domain.GRPCConfig) (*domain.ValidationResult, error)`

**graphql\_checker.go:**
- `Execute(check *domain.Check) (*domain.CheckResult, error)`
- `buildGraphQLRequest(query string, variables map[string]interface{}) ([]byte, error)`
- `validateGraphQLResponse(response []byte, config *domain.GraphQLConfig) (*domain.ValidationResult, error)`

### Функции в internal/service/check\_service.go

- `ExecuteCheck(check *domain.Check) (*domain.CheckResult, error)`
- `GetCheckStatus(checkID string) (*domain.CheckStatus, error)`
- `GetCheckHistory(checkID string, filter *domain.HistoryFilter) ([]*domain.CheckResult, error)`
- `ProcessTask(task *domain.Task) error`
- `BatchExecuteChecks(checks []*domain.Check) ([]*domain.CheckResult, error)`
- `GetCheckStatistics(checkID string, period string) (*domain.Statistics, error)`
- `GetUptime(checkID string, from, to time.Time) (float64, error)`
- `GetResponseTimeMetrics(checkID string, period string) (*domain.ResponseTimeMetrics, error)`
- `ExportResults(checkID string, format string, from, to time.Time) ([]byte, error)`

## 4. Config Service

```
config-service/
├── cmd/server/main.go
├── internal/
│   ├── domain/
│   │   ├── models.go
│   │   └── errors.go
│   ├── repository/
│   │   ├── interfaces.go
│   │   ├── postgres/
│   │   │   ├── base_repository.go
│   │   │   ├── check_repository.go
│   │   │   ├── config_repository.go
│   │   │   └── template_repository.go
│   │   └── redis/
│   │       └── cache_repository.go
│   ├── service/
│   │   ├── interfaces.go
│   │   ├── config_service.go
│   │   └── template_service.go
│   ├── handler/
│   │   └── grpc/
│   │       ├── handler.go
│   │       └── server.go
│   ├── config/
│   │   └── config.go
│   ├── cache/
│   │   └── redis_cache.go
│   ├── validator/
│   │   ├── validator.go
│   │   ├── http_validator.go
│   │   ├── grpc_validator.go
│   │   ├── graphql_validator.go
│   │   ├── tcp_validator.go
│   │   └── composite_validator.go
│   ├── pkg/
│   │   └── config_generator/
│   │       ├── generator.go
│   │       ├── yaml_generator.go
│   │       └── json_generator.go
│   └── worker/
│       └── sync_worker.go
├── api/
│   └── proto/
│       └── config/
│           └── v1/
│               ├── config.proto
│               └── config.pb.go
├── migrations/
│   ├── 001_create_checks.sql
│   ├── 002_create_check_configs.sql
│   ├── 003_create_check_schedules.sql
│   ├── 004_create_templates.sql
│   └── 005_create_check_groups.sql
├── tests/
│   ├── unit/
│   │   ├── service_test.go
│   │   ├── validator_test.go
│   │   └── generator_test.go
│   ├── integration/
│   │   ├── config_integration_test.go
│   │   └── validator_integration_test.go
│   └── e2e/
│       └── config_e2e_test.go
└── deployments/
    ├── docker/
    │   └── Dockerfile
    └── k8s/
        ├── deployment.yaml
        ├── service.yaml
        └── configmap.yaml
```

### Функции в internal/service/config\_service.go

**Check Management:**
- `CreateCheck(tenantID string, check *domain.Check) (*domain.Check, error)`
- `GetCheck(checkID string) (*domain.Check, error)`
- `UpdateCheck(checkID string, check *domain.Check) error`
- `DeleteCheck(checkID string) error`
- `ListChecks(tenantID string, filter *domain.CheckFilter) ([]*domain.Check, error)`
- `ValidateCheckConfig(check *domain.Check) error`
- `DuplicateCheck(checkID string, newName string) (*domain.Check, error)`
- `EnableCheck(checkID string) error`
- `DisableCheck(checkID string) error`
- `BulkUpdateChecks(checkIDs []string, updates map[string]interface{}) error`

**Template Management:**
- `CreateTemplate(tenantID string, template *domain.Template) error`
- `GetTemplate(templateID string) (*domain.Template, error)`
- `UpdateTemplate(templateID string, template *domain.Template) error`
- `DeleteTemplate(templateID string) error`
- `ListTemplates(tenantID string) ([]*domain.Template, error)`
- `ApplyTemplate(checkID, templateID string) error`
- `GenerateFromTemplate(templateID string, variables map[string]string) (*domain.Check, error)`

**Group Management:**
- `CreateGroup(tenantID string, group *domain.CheckGroup) error`
- `AddCheckToGroup(checkID, groupID string) error`
- `RemoveCheckFromGroup(checkID, groupID string) error`
- `GetGroupChecks(groupID string) ([]*domain.Check, error)`
- `ExecuteGroup(groupID string) ([]*domain.CheckResult, error)`

**Import/Export:**
- `ImportChecks(tenantID string, data []byte, format string) ([]*domain.Check, error)`
- `ExportChecks(tenantID string, checkIDs []string, format string) ([]byte, error)`
- `ValidateImportData(data []byte, format string) error`

## 5. Scheduler Service

```
scheduler-service/
├── cmd/server/main.go
├── internal/
│   ├── domain/
│   │   ├── models.go
│   │   └── errors.go
│   ├── repository/
│   │   ├── interfaces.go
│   │   ├── postgres/
│   │   │   ├── base_repository.go
│   │   │   ├── schedule_repository.go
│   │   │   ├── job_repository.go
│   │   │   └── history_repository.go
│   │   └── redis/
│   │       └── lock_repository.go
│   ├── service/
│   │   ├── interfaces.go
│   │   └── scheduler_service.go
│   ├── handler/
│   │   └── grpc/
│   │       ├── handler.go
│   │       └── server.go
│   ├── scheduler/
│   │   ├── cron_scheduler.go
│   │   ├── job_runner.go
│   │   ├── job_store.go
│   │   ├── priority_queue.go
│   │   └── distributed_scheduler.go
│   ├── producer/
│   │   └── rabbitmq/
│   │       ├── producer.go
│   │       ├── dead_letter.go
│   │       └── retry_producer.go
│   ├── config/
│   │   └── config.go
│   ├── lock/
│   │   ├── lock.go
│   │   └── redis_lock.go
│   ├── metrics/
│   │   └── metrics.go
│   └── worker/
│       ├── schedule_worker.go
│       └── cleanup_worker.go
├── api/
│   └── proto/
│       └── scheduler/
│           └── v1/
│               ├── scheduler.proto
│               └── scheduler.pb.go
├── migrations/
│   ├── 001_create_schedules.sql
│   ├── 002_create_jobs.sql
│   ├── 003_create_job_history.sql
│   └── 004_create_schedule_metrics.sql
├── tests/
│   ├── unit/
│   │   ├── scheduler_test.go
│   │   ├── service_test.go
│   │   └── lock_test.go
│   ├── integration/
│   │   ├── scheduler_integration_test.go
│   │   └── distributed_test.go
│   └── e2e/
│       └── scheduler_e2e_test.go
└── deployments/
    ├── docker/
    │   └── Dockerfile
    └── k8s/
        ├── deployment.yaml
        ├── service.yaml
        └── configmap.yaml
```

### Функции в internal/scheduler/cron\_scheduler.go

- `Start() error` - запуск планировщика
- `Stop() error` - graceful остановка
- `AddJob(schedule *domain.Schedule) error`
- `RemoveJob(checkID string) error`
- `UpdateJob(schedule *domain.Schedule) error`
- `PauseJob(checkID string) error`
- `ResumeJob(checkID string) error`
- `ListJobs() []*domain.ScheduledJob`
- `GetNextRun(checkID string) (time.Time, error)`
- `TriggerJob(checkID string) error` - немедленный запуск
- `GetJobStatus(checkID string) (*domain.JobStatus, error)`

### Функции в internal/service/scheduler\_service.go

**Schedule Management:**
- `ScheduleCheck(checkID string, cronExpr string, priority int) (*domain.Schedule, error)`
- `UnscheduleCheck(checkID string) error`
- `GetSchedule(checkID string) (*domain.Schedule, error)`
- `ListSchedules(tenantID string, filter *domain.ScheduleFilter) ([]*domain.Schedule, error)`
- `PauseCheck(checkID string) error`
- `ResumeCheck(checkID string) error`
- `UpdateSchedule(checkID string, schedule *domain.Schedule) error`
- `RunNow(checkID string) error` - немедленный запуск
- `BulkSchedule(checks []*domain.Check) error`
- `BulkUnschedule(checkIDs []string) error`

**Job Management:**
- `ListActiveJobs() ([]*domain.Job, error)`
- `GetJobHistory(checkID string, filter *domain.HistoryFilter) ([]*domain.JobHistory, error)`
- `GetJobStatistics(checkID string, period string) (*domain.JobStatistics, error)`
- `CleanupOldJobs(retentionDays int) error`
- `RetryFailedJob(jobID string) error`

**Monitoring:**
- `GetSchedulerStatus() (*domain.SchedulerStatus, error)`
- `GetQueueStatus() (*domain.QueueStatus, error)`
- `GetWorkerStatus() ([]*domain.WorkerStatus, error)`
- `GetMetrics() (*domain.SchedulerMetrics, error)`

## 6. Incident Manager

```
incident-manager/
├── cmd/server/main.go
├── internal/
│   ├── domain/
│   │   ├── models.go
│   │   └── errors.go
│   ├── repository/
│   │   ├── interfaces.go
│   │   ├── postgres/
│   │   │   ├── base_repository.go
│   │   │   ├── incident_repository.go
│   │   │   ├── event_repository.go
│   │   │   └── rule_repository.go
│   │   └── redis/
│   │       └── cache_repository.go
│   ├── service/
│   │   ├── interfaces.go
│   │   ├── incident_service.go
│   │   ├── deduplicator/
│   │   │   ├── deduplicator.go
│   │   │   ├── hash_generator.go
│   │   │   └── similarity_checker.go
│   │   └── escalation/
│   │       ├── escalation.go
│   │       ├── rule_engine.go
│   │       └── policy_manager.go
│   ├── handler/
│   │   └── grpc/
│   │       ├── handler.go
│   │       └── server.go
│   ├── consumer/
│   │   └── rabbitmq/
│   │       └── consumer.go
│   ├── producer/
│   │   └── rabbitmq/
│   │       └── producer.go
│   ├── config/
│   │   └── config.go
│   ├── client/
│   │   └── notification_client.go
│   └── metrics/
│       └── metrics.go
├── api/
│   └── proto/
│       └── incident/
│           └── v1/
│               ├── incident.proto
│               └── incident.pb.go
├── migrations/
│   ├── 001_create_incidents.sql
│   ├── 002_create_incident_events.sql
│   ├── 003_create_incident_rules.sql
│   └── 004_create_escalation_policies.sql
├── tests/
│   ├── unit/
│   │   ├── service_test.go
│   │   ├── deduplicator_test.go
│   │   └── escalation_test.go
│   ├── integration/
│   │   ├── incident_integration_test.go
│   │   └── deduplication_integration_test.go
│   └── e2e/
│       └── incident_e2e_test.go
└── deployments/
    ├── docker/
    │   └── Dockerfile
    └── k8s/
        ├── deployment.yaml
        ├── service.yaml
        └── configmap.yaml
```

### Функции в internal/service/incident\_service.go

**Incident Processing:**
- `ProcessCheckResult(result *domain.CheckResult) error`
- `CreateIncident(checkID string, result *domain.CheckResult) (*domain.Incident, error)`
- `UpdateIncident(incidentID string, update *domain.IncidentUpdate) error`
- `ResolveIncident(incidentID string, resolution string) error`
- `AcknowledgeIncident(incidentID string, userID string) error`
- `EscalateIncident(incidentID string, level int) error`
- `MergeIncidents(incidentIDs []string) (*domain.Incident, error)`
- `SplitIncident(incidentID string, newIncidents []*domain.Incident) error`

**Incident Querying:**
- `GetIncident(incidentID string) (*domain.Incident, error)`
- `ListIncidents(tenantID string, filter *domain.IncidentFilter) ([]*domain.Incident, error)`
- `GetIncidentEvents(incidentID string) ([]*domain.IncidentEvent, error)`
- `GetOpenIncidents(tenantID string) ([]*domain.Incident, error)`
- `SearchIncidents(query string, filter *domain.IncidentFilter) ([]*domain.Incident, error)`
- `GetIncidentTimeline(incidentID string) ([]*domain.TimelineEvent, error)`

**Rule Management:**
- `CreateRule(tenantID string, rule *domain.Rule) error`
- `UpdateRule(ruleID string, rule *domain.Rule) error`
- `DeleteRule(ruleID string) error`
- `ListRules(tenantID string) ([]*domain.Rule, error)`
- `EvaluateRules(result *domain.CheckResult) ([]*domain.RuleAction, error)`
- `TestRule(rule *domain.Rule, testData *domain.CheckResult) (*domain.RuleResult, error)`

**Statistics:**
- `GetIncidentStatistics(tenantID string, period string) (*domain.IncidentStatistics, error)`
- `GetMTTR(tenantID string, period string) (time.Duration, error)`
- `GetMTBF(tenantID string, period string) (time.Duration, error)`
- `GetAvailability(tenantID string, checkID string, period string) (float64, error)`
- `GetTrends(tenantID string, metric string, period string) (*domain.TrendData, error)`

### Функции в internal/service/deduplicator/deduplicator.go

**Алгоритм дедупликации:**
```go
func Deduplicate(result *domain.CheckResult) (string, error) {
    // 1. Генерация error_hash из ошибки
    errorHash := generateErrorHash(result.Error)
    
    // 2. Поиск открытых инцидентов по check_id и error_hash
    incidents := findOpenIncidents(result.CheckID, errorHash)
    
    // 3. Если найдены похожие инциденты
    if len(incidents) > 0 {
        // 4. Сортировка по времени создания (самый старый первый)
        sortIncidentsByCreatedAt(incidents)
        
        // 5. Возврат ID самого старого инцидента
        return incidents[0].ID, nil
    }
    
    // 6. Если не найдено, возвращаем пустую строку
    return "", nil
}
```

## 7. Notification Service

```
notification-service/
├── cmd/server/main.go
├── internal/
│   ├── domain/
│   │   ├── models.go
│   │   └── errors.go
│   ├── repository/
│   │   ├── interfaces.go
│   │   ├── postgres/
│   │   │   ├── base_repository.go
│   │   │   ├── channel_repository.go
│   │   │   ├── template_repository.go
│   │   │   └── log_repository.go
│   │   └── redis/
│   │       └── rate_limit_repository.go
│   ├── service/
│   │   ├── interfaces.go
│   │   ├── notification_service.go
│   │   ├── template/
│   │   │   ├── template.go
│   │   │   ├── telegram_template.go
│   │   │   ├── slack_template.go
│   │   │   ├── email_template.go
│   │   │   └── webhook_template.go
│   │   └── rate_limit/
│   │       ├── rate_limit.go
│   │       └── token_bucket.go
│   ├── handler/
│   │   └── grpc/
│   │       ├── handler.go
│   │       └── server.go
│   ├── consumer/
│   │   └── rabbitmq/
│   │       └── consumer.go
│   ├── config/
│   │   └── config.go
│   ├── provider/
│   │   ├── interface.go
│   │   ├── telegram/
│   │   │   ├── telegram.go
│   │   │   ├── bot_client.go
│   │   │   └── message_builder.go
│   │   ├── slack/
│   │   │   ├── slack.go
│   │   │   ├── webhook_client.go
│   │   │   └── block_builder.go
│   │   ├── email/
│   │   │   ├── email.go
│   │   │   ├── smtp_client.go
│   │   │   └── template_renderer.go
│   │   ├── webhook/
│   │   │   ├── webhook.go
│   │   │   └── http_client.go
│   │   ├── sms/
│   │   │   ├── sms.go
│   │   │   └── twilio_client.go
│   │   └── push/
│   │       ├── push.go
│   │       └── firebase_client.go
│   └── pkg/
│       ├── retry/
│       │   ├── retry.go
│       │   └── exponential_backoff.go
│       ├── validator/
│       │   └── channel_validator.go
│       └── transformer/
│           └── data_transformer.go
├── api/
│   └── proto/
│       └── notification/
│           └── v1/
│               ├── notification.proto
│               └── notification.pb.go
├── migrations/
│   ├── 001_create_notification_channels.sql
│   ├── 002_create_templates.sql
│   ├── 003_create_notification_logs.sql
│   ├── 004_create_user_preferences.sql
│   └── 005_create_notification_rules.sql
├── tests/
│   ├── unit/
│   │   ├── service_test.go
│   │   ├── provider_test.go
│   │   └── template_test.go
│   ├── integration/
│   │   ├── notification_integration_test.go
│   │   └── provider_integration_test.go
│   └── e2e/
│       └── notification_e2e_test.go
└── deployments/
    ├── docker/
    │   └── Dockerfile
    └── k8s/
        ├── deployment.yaml
        ├── service.yaml
        └── configmap.yaml
```

### Функции в internal/service/notification\_service.go

**Notification Management:**
- `SendNotification(tenantID string, notification *domain.Notification) error`
- `SendBulkNotifications(notifications []*domain.Notification) error`
- `ScheduleNotification(notification *domain.Notification, scheduleTime time.Time) error`
- `CancelScheduledNotification(notificationID string) error`
- `RetryFailedNotification(notificationID string) error`
- `GetNotificationStatus(notificationID string) (*domain.NotificationStatus, error)`
- `ListNotifications(tenantID string, filter *domain.NotificationFilter) ([]*domain.Notification, error)`
- `GetNotificationLogs(notificationID string) ([]*domain.NotificationLog, error)`

**Channel Management:**
- `RegisterChannel(tenantID string, channel *domain.Channel) error`
- `UnregisterChannel(channelID string) error`
- `ListChannels(tenantID string) ([]*domain.Channel, error)`
- `UpdateChannel(channelID string, channel *domain.Channel) error`
- `TestChannel(channelID string) error`
- `ValidateChannelConfig(channelType string, config map[string]interface{}) error`
- `GetChannelStatistics(channelID string, period string) (*domain.ChannelStatistics, error)`

**Template Management:**
- `CreateTemplate(tenantID string, template *domain.Template) error`
- `UpdateTemplate(templateID string, template *domain.Template) error`
- `DeleteTemplate(templateID string) error`
- `ListTemplates(tenantID string) ([]*domain.Template, error)`
- `RenderTemplate(templateID string, data map[string]interface{}) (string, error)`
- `PreviewTemplate(templateID string, data map[string]interface{}) (*domain.RenderedTemplate, error)`

**Preference Management:**
- `SetUserPreference(userID string, preference *domain.Preference) error`
- `GetUserPreference(userID string) (*domain.Preference, error)`
- `SetTenantPreference(tenantID string, preference *domain.Preference) error`
- `GetTenantPreference(tenantID string) (*domain.Preference, error)`
- `OverridePreference(userID, tenantID string, preference *domain.Preference) error`

**Rule Management:**
- `CreateNotificationRule(tenantID string, rule *domain.NotificationRule) error`
- `UpdateNotificationRule(ruleID string, rule *domain.NotificationRule) error`
- `DeleteNotificationRule(ruleID string) error`
- `ListNotificationRules(tenantID string) ([]*domain.NotificationRule, error)`
- `EvaluateRules(event *domain.Event) ([]*domain.NotificationRule, error)`

### Функции в internal/provider/interface.go

```go
type Provider interface {
    // Send отправляет уведомление
    Send(notification *domain.Notification) error
    
    // Validate проверяет конфигурацию канала
    Validate(channel *domain.Channel) error
    
    // Test тестирует соединение с каналом
    Test(channel *domain.Channel) error
    
    // GetType возвращает тип провайдера
    GetType() string
    
    // GetCapabilities возвращает возможности провайдера
    GetCapabilities() []string
    
    // GetRateLimit возвращает лимиты для провайдера
    GetRateLimit() *domain.RateLimit
}
```

## 8. Forge Service

```
forge-service/
├── cmd/server/main.go
├── internal/
│   ├── domain/
│   │   ├── models.go
│   │   └── errors.go
│   ├── repository/
│   │   ├── interfaces.go
│   │   ├── postgres/
│   │   │   ├── base_repository.go
│   │   │   ├── template_repository.go
│   │   │   ├── proto_repository.go
│   │   │   └── generation_repository.go
│   │   └── redis/
│   │       └── cache_repository.go
│   ├── service/
│   │   ├── interfaces.go
│   │   ├── forge_service.go
│   │   ├── parser/
│   │   │   ├── parser.go
│   │   │   ├── protobuf_parser.go
│   │   │   ├── ast_parser.go
│   │   │   └── dependency_resolver.go
│   │   ├── generator/
│   │   │   ├── config_generator.go
│   │   │   ├── code_generator.go
│   │   │   ├── test_generator.go
│   │   │   └── documentation_generator.go
│   │   └── validator/
│   │       ├── proto_validator.go
│   │       ├── config_validator.go
│   │       └── template_validator.go
│   ├── handler/
│   │   └── grpc/
│   │       ├── handler.go
│   │       └── server.go
│   ├── config/
│   │   └── config.go
│   └── templates/
│       ├── config/
│       │   ├── http_check.yaml.tmpl
│       │   ├── grpc_check.yaml.tmpl
│       │   ├── graphql_check.yaml.tmpl
│       │   ├── tcp_check.yaml.tmpl
│       │   └── composite_check.yaml.tmpl
│       ├── code/
│       │   ├── grpc_check.go.tmpl
│       │   ├── http_check.go.tmpl
│       │   ├── checker_interface.go.tmpl
│       │   └── validator.go.tmpl
│       ├── tests/
│       │   ├── check_test.go.tmpl
│       │   ├── integration_test.go.tmpl
│       │   └── benchmark_test.go.tmpl
│       └── docs/
│           ├── api_documentation.md.tmpl
│           └── check_specification.md.tmpl
├── api/
│   └── proto/
│       └── forge/
│           └── v1/
│               ├── forge.proto
│               └── forge.pb.go
├── migrations/
│   ├── 001_create_proto_templates.sql
│   ├── 002_create_generation_logs.sql
│   └── 003_create_custom_templates.sql
├── tests/
│   ├── unit/
│   │   ├── parser_test.go
│   │   ├── generator_test.go
│   │   └── validator_test.go
│   ├── integration/
│   │   ├── forge_integration_test.go
│   │   └── generation_integration_test.go
│   └── e2e/
│       └── forge_e2e_test.go
└── deployments/
    ├── docker/
    │   └── Dockerfile
    └── k8s/
        ├── deployment.yaml
        ├── service.yaml
        └── configmap.yaml
```

### Функции в internal/service/forge\_service.go

**Proto Processing:**
- `ParseProto(protoContent []byte) (*domain.ProtoFile, error)`
- `ParseProtoFromFile(filePath string) (*domain.ProtoFile, error)`
- `ParseProtoFromURL(url string) (*domain.ProtoFile, error)`
- `ValidateProto(protoContent []byte) error`
- `LintProto(protoContent []byte) ([]*domain.LintIssue, error)`
- `FormatProto(protoContent []byte) ([]byte, error)`
- `ResolveDependencies(protoFile *domain.ProtoFile) ([]*domain.ProtoFile, error)`
- `ExtractServices(protoFile *domain.ProtoFile) ([]*domain.Service, error)`
- `ExtractMethods(service *domain.Service) ([]*domain.Method, error)`

**Generation:**
- `GenerateConfig(protoFile *domain.ProtoFile, options *domain.GenerationOptions) (*domain.GeneratedConfig, error)`
- `GenerateCode(protoFile *domain.ProtoFile, options *domain.GenerationOptions) ([]byte, error)`
- `GenerateTests(protoFile *domain.ProtoFile, options *domain.GenerationOptions) ([]byte, error)`
- `GenerateDocumentation(protoFile *domain.ProtoFile, options *domain.GenerationOptions) ([]byte, error)`
- `GenerateAll(protoFile *domain.ProtoFile, options *domain.GenerationOptions) (*domain.GenerationResult, error)`
- `PreviewGeneration(protoFile *domain.ProtoFile, options *domain.GenerationOptions) (*domain.GenerationPreview, error)`
- `ValidateGeneratedConfig(config *domain.GeneratedConfig) error`

**Template Management:**
- `SaveTemplate(tenantID string, template *domain.ProtoTemplate) error`
- `GetTemplate(templateID string) (*domain.ProtoTemplate, error)`
- `ListTemplates(tenantID string) ([]*domain.ProtoTemplate, error)`
- `DeleteTemplate(templateID string) error`
- `UpdateTemplate(templateID string, template *domain.ProtoTemplate) error`
- `DuplicateTemplate(templateID string, newName string) error`
- `ApplyTemplate(protoFile *domain.ProtoFile, templateID string) (*domain.GeneratedConfig, error)`
- `ExportTemplates(tenantID string) ([]byte, error)`
- `ImportTemplates(tenantID string, data []byte) error`

**Customization:**
- `CreateCustomTemplate(tenantID string, template *domain.CustomTemplate) error`
- `UpdateCustomTemplate(templateID string, template *domain.CustomTemplate) error`
- `DeleteCustomTemplate(templateID string) error`
- `ListCustomTemplates(tenantID string) ([]*domain.CustomTemplate, error)`
- `ValidateCustomTemplate(template *domain.CustomTemplate) error`
- `RenderCustomTemplate(templateID string, data map[string]interface{}) (string, error)`

**Batch Operations:**
- `BatchGenerate(configs []*domain.GenerationRequest) ([]*domain.GenerationResult, error)`
- `GenerateFromDirectory(dirPath string, options *domain.GenerationOptions) ([]*domain.GenerationResult, error)`
- `GenerateFromGitRepo(repoURL string, options *domain.GenerationOptions) ([]*domain.GenerationResult, error)`

## 9. Metrics Service

```
metrics-service/
├── cmd/server/main.go
├── internal/
│   ├── handler/
│   │   └── http/
│   │       ├── handler.go
│   │       ├── metrics_handler.go
│   │       ├── health_handler.go
│   │       └── api_handler.go
│   ├── collector/
│   │   ├── interface.go
│   │   ├── grpc_collector.go
│   │   ├── http_collector.go
│   │   ├── database_collector.go
│   │   ├── queue_collector.go
│   │   ├── system_collector.go
│   │   └── custom_collector.go
│   ├── exporter/
│   │   ├── prometheus_exporter.go
│   │   ├── json_exporter.go
│   │   ├── influxdb_exporter.go
│   │   ├── datadog_exporter.go
│   │   └── stdout_exporter.go
│   ├── storage/
│   │   ├── interface.go
│   │   ├── inmemory_storage.go
│   │   ├── redis_storage.go
│   │   ├── timeseries_storage.go
│   │   └── partitioned_storage.go
│   ├── aggregator/
│   │   ├── aggregator.go
│   │   ├── calculator.go
│   │   ├── window_aggregator.go
│   │   ├── percentile_calculator.go
│   │   └── trend_calculator.go
│   ├── config/
│   │   └── config.go
│   ├── client/
│   │   ├── service_client.go
│   │   ├── discovery_client.go
│   │   └── scrape_client.go
│   ├── alerting/
│   │   ├── alert_manager.go
│   │   ├── rule_engine.go
│   │   ├── evaluator.go
│   │   └── notifier.go
│   ├── query/
│   │   ├── query_engine.go
│   │   ├── parser.go
│   │   ├── executor.go
│   │   └── optimizer.go
│   └── dashboard/
│       ├── dashboard_manager.go
│       ├── widget_renderer.go
│       └── template_renderer.go
├── deployments/
│   ├── docker/
│   │   └── Dockerfile
│   └── k8s/
│       ├── deployment.yaml
│       ├── service.yaml
│       ├── configmap.yaml
│       └── service_monitor.yaml
├── .env.example
├── go.mod
├── go.sum
└── README.md
```

### Функции в internal/handler/http/metrics\_handler.go

- `MetricsHandler(w http.ResponseWriter, r *http.Request)` - обработчик /metrics (Prometheus формат)
- `QueryHandler(w http.ResponseWriter, r *http.Request)` - API для запроса метрик
- `RangeQueryHandler(w http.ResponseWriter, r *http.Request)` - запрос метрик за период
- `AggregateHandler(w http.ResponseWriter, r *http.Request)` - агрегированные метрики
- `TopHandler(w http.ResponseWriter, r *http.Request)` - топ N метрик
- `HealthHandler(w http.ResponseWriter, r *http.Request)` - /health
- `ReadyHandler(w http.ResponseWriter, r *http.Request)` - /ready
- `ConfigHandler(w http.ResponseWriter, r *http.Request)` - конфигурация метрик
- `TargetsHandler(w http.ResponseWriter, r *http.Request)` - список targets для сбора

### Функции в internal/collector/grpc\_collector.go

- `CollectFromService(serviceName, endpoint string) ([]*domain.Metric, error)`
- `CollectFromAllServices() (map[string][]*domain.Metric, error)`
- `StartCollection(interval time.Duration) error`
- `StopCollection() error`
- `GetCollectionStatus() (*domain.CollectionStatus, error)`
- `UpdateCollectionConfig(config *domain.CollectionConfig) error`
- `ListTargets() ([]*domain.CollectionTarget, error)`
- `AddTarget(target *domain.CollectionTarget) error`
- `RemoveTarget(targetID string) error`
- `TestTarget(target *domain.CollectionTarget) error`

### Основные метрики для каждого сервиса:

**API Gateway:**
- `uptime_gateway_requests_total{method, path, status, tenant}`
- `uptime_gateway_request_duration_seconds{method, path, quantile="0.5,0.9,0.99"}`
- `uptime_gateway_active_connections`
- `uptime_gateway_request_size_bytes{method, path}`
- `uptime_gateway_response_size_bytes{method, path}`
- `uptime_gateway_errors_total{type}`

**Auth Service:**
- `uptime_auth_requests_total{method, status}`
- `uptime_auth_request_duration_seconds{method}`
- `uptime_auth_tokens_generated_total`
- `uptime_auth_tokens_validated_total`
- `uptime_auth_tokens_revoked_total`
- `uptime_auth_users_active`
- `uptime_auth_sessions_active`
- `uptime_auth_rate_limit_exceeded_total`

**Core Service:**
- `uptime_checks_executed_total{type, status, tenant}`
- `uptime_check_duration_seconds{type, status, quantile="0.5,0.9,0.99"}`
- `uptime_checks_active{type}`
- `uptime_check_queue_size`
- `uptime_workers_active`
- `uptime_check_success_rate{type, tenant}`
- `uptime_check_errors_total{type, error_type}`

**Scheduler Service:**
- `uptime_scheduled_jobs_total{status}`
- `uptime_jobs_executed_total{status}`
- `uptime_jobs_pending`
- `uptime_jobs_failed_total`
- `uptime_scheduler_queue_size`
- `uptime_scheduler_latency_seconds`
- `uptime_scheduler_errors_total`

**Incident Manager:**
- `uptime_incidents_total{severity, status, tenant}`
- `uptime_incidents_open{severity}`
- `uptime_incidents_resolved_total`
- `uptime_incident_duration_seconds{severity}`
- `uptime_mttr_seconds{tenant}`
- `uptime_mtbf_seconds{tenant}`
- `uptime_availability_percent{tenant, check}`

**Notification Service:**
- `uptime_notifications_sent_total{provider, status, tenant}`
- `uptime_notifications_failed_total{provider}`
- `uptime_notifications_pending`
- `uptime_notification_duration_seconds{provider}`
- `uptime_notification_queue_size`
- `uptime_rate_limit_exceeded_total{provider}`

**Config Service:**
- `uptime_checks_configured_total{type, tenant}`
- `uptime_config_updates_total`
- `uptime_config_validations_total`
- `uptime_templates_total{type}`
- `uptime_groups_total`

**Forge Service:**
- `uptime_proto_files_parsed_total`
- `uptime_configs_generated_total`
- `uptime_code_generated_total`
- `uptime_generation_duration_seconds`
- `uptime_generation_errors_total`

**Системные метрики:**
- `uptime_service_memory_usage_bytes`
- `uptime_service_cpu_usage_percent`
- `uptime_service_goroutines`
- `uptime_service_uptime_seconds`
- `uptime_database_connections_active`
- `uptime_redis_connections_active`
- `uptime_rabbitmq_connections_active`
- `uptime_queue_messages_total`

## 10. CLI Service

```
cli/
├── cmd/
│   ├── root.go
│   ├── auth.go
│   ├── config.go
│   ├── checks.go
│   ├── incidents.go
│   ├── notifications.go
│   ├── forge.go
│   ├── metrics.go
│   ├── completion.go
│   └── version.go
├── internal/
│   ├── auth/
│   │   ├── auth.go
│   │   ├── login.go
│   │   ├── token_store.go
│   │   └── refresh.go
│   ├── client/
│   │   ├── client.go
│   │   ├── auth_client.go
│   │   ├── config_client.go
│   │   ├── scheduler_client.go
│   │   ├── core_client.go
│   │   ├── incident_client.go
│   │   ├── notification_client.go
│   │   └── forge_client.go
│   ├── config/
│   │   ├── config.go
│   │   ├── loader.go
│   │   └── validator.go
│   ├── output/
│   │   ├── formatter.go
│   │   ├── table_formatter.go
│   │   ├── json_formatter.go
│   │   ├── yaml_formatter.go
│   │   ├── csv_formatter.go
│   │   └── color.go
│   ├── store/
│   │   ├── token_store.go
│   │   ├── config_store.go
│   │   └── cache_store.go
│   ├── utils/
│   │   ├── file_utils.go
│   │   ├── validation.go
│   │   ├── prompt.go
│   │   └── spinner.go
│   └── pkg/
│       ├── interactive/
│       │   ├── wizard.go
│       │   └── survey.go
│       ├── editor/
│       │   └── editor.go
│       └── completer/
│           └── completer.go
├── completions/
│   ├── bash/
│   │   └── uptimeping
│   ├── zsh/
│   │   └── _uptimeping
│   └── fish/
│       └── uptimeping.fish
├── examples/
│   ├── config-examples/
│   │   ├── http-check.yaml
│   │   ├── grpc-check.yaml
│   │   └── graphql-check.yaml
│   └── scripts/
│       ├── monitor.sh
│       └── backup.sh
├── docs/
│   ├── MANUAL.md
│   ├── EXAMPLES.md
│   └── TROUBLESHOOTING.md
├── tests/
│   ├── unit/
│   │   ├── command_test.go
│   │   └── client_test.go
│   ├── integration/
│   │   └── cli_integration_test.go
│   └── e2e/
│       └── cli_e2e_test.go
├── .goreleaser.yml
├── go.mod
├── go.sum
├── Makefile
└── README.md
```

### Команды CLI:

**Корневая команда (`uptimeping`):**
- `uptimeping --version` - версия CLI
- `uptimeping --help` - помощь
- `uptimeping completion` - генерация скриптов автодополнения
- `uptimeping config` - управление конфигурацией CLI

**Аутентификация (`uptimeping auth`):**
- `uptimeping auth login` - интерактивный вход
- `uptimeping auth logout` - выход
- `uptimeping auth status` - статус аутентификации
- `uptimeping auth whoami` - информация о текущем пользователе
- `uptimeping auth api-key create` - создание API ключа
- `uptimeping auth api-key list` - список API ключей
- `uptimeping auth api-key revoke <id>` - отзыв API ключа

**Конфигурации (`uptimeping config`):**
- `uptimeping config get <id>` - получение конфигурации проверки
- `uptimeping config create` - создание новой проверки
- `uptimeping config update <id>` - обновление проверки
- `uptimeping config delete <id>` - удаление проверки
- `uptimeping config list` - список проверок
- `uptimeping config validate <file>` - валидация конфигурации
- `uptimeping config export` - экспорт конфигураций
- `uptimeping config import <file>` - импорт конфигураций
- `uptimeping config duplicate <id>` - дублирование проверки
- `uptimeping config enable <id>` - включение проверки
- `uptimeping config disable <id>` - отключение проверки

**Проверки (`uptimeping checks`):**
- `uptimeping checks run <id>` - ручной запуск проверки
- `uptimeping checks status <id>` - статус проверки
- `uptimeping checks history <id>` - история выполнения
- `uptimeping checks stats <id>` - статистика проверки
- `uptimeping checks list` - список активных проверок
- `uptimeping checks monitor <id>` - мониторинг проверки в реальном времени
- `uptimeping checks test <file>` - тестирование проверки из файла

**Расписания (`uptimeping schedules`):**
- `uptimeping schedules list` - список расписаний
- `uptimeping schedules get <id>` - детали расписания
- `uptimeping schedules pause <id>` - пауза расписания
- `uptimeping schedules resume <id>` - возобновление расписания
- `uptimeping schedules run-now <id>` - немедленный запуск
- `uptimeping schedules history <id>` - история выполнения

**Инциденты (`uptimeping incidents`):**
- `uptimeping incidents list` - список инцидентов
- `uptimeping incidents get <id>` - детали инцидента
- `uptimeping incidents acknowledge <id>` - подтверждение инцидента
- `uptimeping incidents resolve <id>` - разрешение инцидента
- `uptimeping incidents timeline <id>` - таймлайн инцидента
- `uptimeping incidents stats` - статистика инцидентов
- `uptimeping incidents monitor` - мониторинг новых инцидентов

**Уведомления (`uptimeping notifications`):**
- `uptimeping notifications channels list` - список каналов
- `uptimeping notifications channels add` - добавление канала
- `uptimeping notifications channels remove <id>` - удаление канала
- `uptimeping notifications channels test <id>` - тест канала
- `uptimeping notifications templates list` - список шаблонов
- `uptimeping notifications send` - отправка тестового уведомления
- `uptimeping notifications history` - история уведомлений

**Forge (`uptimeping forge`):**
- `uptimeping forge parse <file>` - парсинг .proto файла
- `uptimeping forge generate <file>` - генерация конфига
- `uptimeping forge validate <file>` - валидация .proto файла
- `uptimeping forge templates list` - список шаблонов
- `uptimeping forge templates create` - создание шаблона
- `uptimeping forge templates get <id>` - получение шаблона
- `uptimeping forge templates update <id>` - обновление шаблона
- `uptimeping forge templates delete <id>` - удаление шаблона
- `uptimeping forge generate-all <dir>` - генерация из директории

**Метрики (`uptimeping metrics`):**
- `uptimeping metrics query <query>` - запрос метрик
- `uptimeping metrics list` - список доступных метрик
- `uptimeping metrics dashboard` - запуск дашборда
- `uptimeping metrics export` - экспорт метрик
- `uptimeping metrics alerts` - список алертов
- `uptimeping metrics status` - статус сбора метрик

**Утилиты (`uptimeping utils`):**
- `uptimeping utils backup` - создание бэкапа
- `uptimeping utils restore` - восстановление из бэкапа
- `uptimeping utils migrate` - запуск миграций
- `uptimeping utils health` - проверка здоровья сервисов
- `uptimeping utils version` - версии всех сервисов

### Функции в internal/auth/auth.go

**Алгоритм логина:**
```go
func Login(interactive bool) error {
    if interactive {
        // 1. Запрос email и password
        email := prompt.ForEmail()
        password := prompt.ForPassword()
        
        // 2. Вызов API Gateway
        resp, err := client.Login(email, password)
        if err != nil {
            return err
        }
        
        // 3. Сохранение токенов
        store.SaveTokens(resp.AccessToken, resp.RefreshToken)
        store.SaveUserInfo(resp.User)
        
        // 4. Сохранение конфигурации
        config.SaveAPIConfig(resp.APIEndpoint)
        
        fmt.Println("Login successful!")
        return nil
    } else {
        // Non-interactive режим (для CI/CD)
        // Использование переменных окружения или аргументов
    }
}
```

### Функции в internal/output/table\_formatter.go

```go
func FormatChecksTable(checks []*domain.Check) string {
    table := tablewriter.NewWriter(os.Stdout)
    table.SetHeader([]string{"ID", "Name", "Type", "Target", "Status", "Last Check"})
    table.SetBorder(false)
    table.SetHeaderColor(
        tablewriter.Colors{tablewriter.Bold, tablewriter.FgGreenColor},
        tablewriter.Colors{tablewriter.Bold, tablewriter.FgGreenColor},
        tablewriter.Colors{tablewriter.Bold, tablewriter.FgGreenColor},
        tablewriter.Colors{tablewriter.Bold, tablewriter.FgGreenColor},
        tablewriter.Colors{tablewriter.Bold, tablewriter.FgGreenColor},
        tablewriter.Colors{tablewriter.Bold, tablewriter.FgGreenColor},
    )
    
    for _, check := range checks {
        statusColor := tablewriter.FgGreenColor
        if check.Status == "failing" {
            statusColor = tablewriter.FgRedColor
        } else if check.Status == "unknown" {
            statusColor = tablewriter.FgYellowColor
        }
        
        table.Rich([]string{
            check.ID[:8],
            check.Name,
            check.Type,
            check.Target,
            check.Status,
            formatTime(check.LastChecked),
        }, []tablewriter.Colors{
            {},
            {},
            {},
            {},
            {tablewriter.Bold, statusColor},
            {},
        })
    }
    
    var buf bytes.Buffer
    table.SetOutput(&buf)
    table.Render()
    return buf.String()
}
```

## 11. Общие пакеты (pkg/) - полная структура

```
uptimeping-platform/pkg/
├── config/
│   ├── config.go
│   ├── loader.go
│   ├── validator.go
│   ├── env_loader.go
│   ├── file_loader.go
│   ├── vault_loader.go
│   └── hot_reload.go
├── logger/
│   ├── logger.go
│   ├── zap_logger.go
│   ├── context_logger.go
│   ├── fields.go
│   ├── formatter.go
│   ├── hooks.go
│   ├── middleware.go
│   └── writer.go
├── errors/
│   ├── errors.go
│   ├── grpc_errors.go
│   ├── http_errors.go
│   ├── validation_errors.go
│   ├── domain_errors.go
│   ├── stack_trace.go
│   ├── recovery.go
│   └── translator.go
├── database/
│   ├── postgres.go
│   ├── migrations.go
│   ├── health.go
│   ├── connection_pool.go
│   ├── retry.go
│   ├── transaction.go
│   ├── query_builder.go
│   ├── scanner.go
│   └── seeder.go
├── redis/
│   ├── client.go
│   ├── cache.go
│   ├── lock.go
│   ├── pubsub.go
│   ├── health.go
│   ├── connection_pool.go
│   ├── cluster_client.go
│   ├── sentinel_client.go
│   └── scripts/
│       ├── rate_limit.lua
│       └── distributed_lock.lua
├── rabbitmq/
│   ├── connection.go
│   ├── producer.go
│   ├── consumer.go
│   ├── health.go
│   ├── retry.go
│   ├── dead_letter.go
│   ├── exchange.go
│   ├── queue.go
│   └── message.go
├── metrics/
│   ├── metrics.go
│   ├── http_metrics.go
│   ├── grpc_metrics.go
│   ├── database_metrics.go
│   ├── redis_metrics.go
│   ├── rabbitmq_metrics.go
│   ├── business_metrics.go
│   ├── exporter.go
│   └── middleware.go
├── health/
│   ├── health.go
│   ├── checker.go
│   ├── http_checker.go
│   ├── grpc_checker.go
│   ├── database_checker.go
│   ├── redis_checker.go
│   ├── rabbitmq_checker.go
│   ├── composite_checker.go
│   └── liveness.go
├── validator/
│   ├── validator.go
│   ├── struct_validator.go
│   ├── field_validator.go
│   ├── custom_validator.go
│   ├── tag_parser.go
│   ├── rules.go
│   └── errors.go
├── security/
│   ├── crypto.go
│   ├── sanitizer.go
│   ├── xss.go
│   ├── sql_injection.go
│   ├── jwt.go
│   ├── api_key.go
│   ├── password.go
│   ├── encryption.go
│   └── rate_limit.go
├── http/
│   ├── client.go
│   ├── middleware.go
│   ├── router.go
│   ├── response.go
│   ├── request.go
│   ├── cors.go
│   ├── compression.go
│   ├── timeout.go
│   └── circuit_breaker.go
├── grpc/
│   ├── client.go
│   ├── interceptor.go
│   ├── server.go
│   ├── health.go
│   ├── reflection.go
│   ├── balancer.go
│   ├── retry.go
│   ├── timeout.go
│   └── circuit_breaker.go
├── tracing/
│   ├── tracer.go
│   ├── middleware.go
│   ├── exporter.go
│   ├── propagator.go
│   ├── sampler.go
│   ├── span.go
│   └── attributes.go
├── cache/
│   ├── cache.go
│   ├── redis_cache.go
│   ├── memory_cache.go
│   ├── multi_level_cache.go
│   ├── strategy.go
│   ├── ttl.go
│   └── invalidation.go
├── queue/
│   ├── queue.go
│   ├── rabbitmq_queue.go
│   ├── memory_queue.go
│   ├── priority_queue.go
│   ├── delayed_queue.go
│   ├── worker_pool.go
│   └── dead_letter.go
├── event/
│   ├── event.go
│   ├── publisher.go
│   ├── subscriber.go
│   ├── bus.go
│   ├── handler.go
│   └── middleware.go
├── workflow/
│   ├── workflow.go
│   ├── step.go
│   ├── executor.go
│   ├── scheduler.go
│   └── monitor.go
├── scheduler/
│   ├── scheduler.go
│   ├── cron_scheduler.go
│   ├── job.go
│   ├── store.go
│   ├── distributed.go
│   └── lock.go
├── notification/
│   ├── notification.go
│   ├── channel.go
│   ├── template.go
│   ├── sender.go
│   └── rate_limit.go
├── monitoring/
│   ├── monitor.go
│   ├── check.go
│   ├── alert.go
│   ├── dashboard.go
│   └── report.go
├── utils/
│   ├── uuid.go
│   ├── time.go
│   ├── string.go
│   ├── slice.go
│   ├── map.go
│   ├── file.go
│   ├── network.go
│   ├── retry.go
│   ├── backoff.go
│   ├── circuit_breaker.go
│   ├── context.go
│   ├── reflection.go
│   ├── testing.go
│   └── panic_recovery.go
├── testing/
│   ├── test_suite.go
│   ├── mock.go
│   ├── fixture.go
│   ├── assertion.go
│   ├── integration.go
│   ├── e2e.go
│   └── benchmark.go
└── docs/
    ├── README.md
    └── EXAMPLES.md
```

## 12. Корневая структура проекта

```
uptimeping-platform/
├── .gitignore
├── README.md
├── ARCHITECTURE.md
├── CONTRIBUTING.md
├── DEVELOPMENT.md
├── COMMIT_CONVENTIONS.md
├── BRANCH_STRATEGY.md
├── CHANGELOG.md
├── LICENSE
├── go.work
├── buf.yaml
├── buf.gen.yaml
├── .goreleaser.yml
├── .gitlab-ci.yml
├── Makefile
├── services/
│   ├── api-gateway/
│   ├── auth-service/
│   ├── config-service/
│   ├── scheduler-service/
│   ├── core-service/
│   ├── incident-manager/
│   ├── notification-service/
│   ├── forge-service/
│   ├── metrics-service/
│   └── cli/
├── pkg/
│   ├── config/
│   ├── logger/
│   ├── errors/
│   ├── database/
│   ├── redis/
│   ├── rabbitmq/
│   ├── metrics/
│   ├── health/
│   ├── validator/
│   ├── security/
│   ├── http/
│   ├── grpc/
│   ├── tracing/
│   ├── cache/
│   ├── queue/
│   ├── event/
│   ├── workflow/
│   ├── scheduler/
│   ├── notification/
│   ├── monitoring/
│   └── utils/
├── proto/
│   └── api/
│       ├── auth/
│       │   └── v1/
│       │       └── auth.proto
│       ├── config/
│       │   └── v1/
│       │       └── config.proto
│       ├── scheduler/
│       │   └── v1/
│       │       └── scheduler.proto
│       ├── core/
│       │   └── v1/
│       │       └── core.proto
│       ├── incident/
│       │   └── v1/
│       │       └── incident.proto
│       ├── notification/
│       │   └── v1/
│       │       └── notification.proto
│       ├── forge/
│       │   └── v1/
│       │       └── forge.proto
│       └── gateway/
│           └── v1/
│               └── gateway.proto
├── deployments/
│   ├── docker-compose/
│   │   ├── docker-compose.yml
│   │   ├── docker-compose.dev.yml
│   │   ├── docker-compose.test.yml
│   │   ├── docker-compose.prod.yml
│   │   ├── .env.example
│   │   ├── prometheus/
│   │   │   └── prometheus.yml
│   │   ├── grafana/
│   │   │   ├── provisioning/
│   │   │   │   ├── datasources.yml
│   │   │   │   └── dashboards.yml
│   │   │   └── dashboards/
│   │   │       ├── uptimeping-overview.json
│   │   │       ├── uptimeping-checks.json
│   │   │       └── uptimeping-incidents.json
│   │   ├── loki/
│   │   │   └── loki-config.yml
│   │   └── promtail/
│   │       └── promtail-config.yml
│   └── k8s/
│       ├── namespaces/
│       │   ├── uptimeping-dev.yaml
│       │   ├── uptimeping-staging.yaml
│       │   └── uptimeping-prod.yaml
│       ├── configs/
│       │   ├── uptimeping-config.yaml
│       │   ├── uptimeping-secrets.yaml
│       │   └── uptimeping-certificates.yaml
│       ├── networking/
│       │   ├── ingress.yaml
│       │   ├── network-policies.yaml
│       │   └── service-mesh.yaml
│       ├── monitoring/
│       │   ├── prometheus-operator/
│       │   │   ├── prometheus.yaml
│       │   │   ├── alertmanager.yaml
│       │   │   └── grafana.yaml
│       │   ├── loki-stack/
│       │   │   ├── loki.yaml
│       │   │   └── promtail.yaml
│       │   └── service-monitors/
│       │       ├── api-gateway-monitor.yaml
│       │       ├── auth-service-monitor.yaml
│       │       └── core-service-monitor.yaml
│       ├── storage/
│       │   ├── postgres-pvc.yaml
│       │   ├── redis-pvc.yaml
│       │   └── rabbitmq-pvc.yaml
│       ├── services/
│       │   ├── api-gateway/
│       │   │   ├── deployment.yaml
│       │   │   ├── service.yaml
│       │   │   ├── hpa.yaml
│       │   │   └── pdb.yaml
│       │   ├── auth-service/
│       │   │   ├── deployment.yaml
│       │   │   ├── service.yaml
│       │   │   ├── hpa.yaml
│       │   │   └── pdb.yaml
│       │   └── ... (для каждого сервиса)
│       └── jobs/
│           ├── migrations.yaml
│           ├── backup.yaml
│           └── cleanup.yaml
├── scripts/
│   ├── setup.sh
│   ├── start.sh
│   ├── stop.sh
│   ├── reset.sh
│   ├── wait-for-db.sh
│   ├── wait-for-redis.sh
│   ├── wait-for-rabbitmq.sh
│   ├── init-db.sh
│   ├── migrate.sh
│   ├── seed.sh
│   ├── backup.sh
│   ├── restore.sh
│   ├── health-check.sh
│   ├── deploy.sh
│   ├── build-all.sh
│   ├── test-all.sh
│   ├── lint-all.sh
│   └── generate-proto.sh
├── docs/
│   ├── api/
│   │   ├── REST-API.md
│   │   ├── gRPC-API.md
│   │   └── CLI-API.md
│   ├── architecture/
│   │   ├── overview.md
│   │   ├── data-flow.md
│   │   └── deployment.md
│   ├── guides/
│   │   ├── getting-started.md
│   │   ├── configuration.md
│   │   └── troubleshooting.md
│   └── api-reference/
│       ├── openapi.yaml
│       └── postman-collection.json
└── tests/
    ├── integration/
    │   ├── api-integration/
    │   │   ├── auth_test.go
    │   │   ├── checks_test.go
    │   │   └── incidents_test.go
    │   └── service-integration/
    │       ├── auth-service_test.go
    │       ├── core-service_test.go
    │       └── scheduler-service_test.go
    └── e2e/
        ├── full-workflow_test.go
        ├── performance_test.go
        └── reliability_test.go
```

