syntax = "proto3";

package uptimeping.metrics.v1;

//import "google/api/annotations.proto";

option go_package = "gitlab.com/rodionov_v_al/UptimePingPlatform/gen/go/proto/api/metrics/v1";

// MetricsService предоставляет методы для сбора и экспорта метрик
service MetricsService {
  // CollectMetrics собирает метрики со всех сервисов
  rpc CollectMetrics(CollectMetricsRequest) returns (CollectMetricsResponse) {}
  
  // ExportMetrics экспортирует метрики в указанный формат
  rpc ExportMetrics(ExportMetricsRequest) returns (stream ExportMetricsResponse) {}
  
  // GetMetrics возвращает текущие значения метрик
  rpc GetMetrics(GetMetricsRequest) returns (GetMetricsResponse) {}
}

// CollectMetricsRequest содержит параметры сбора метрик
message CollectMetricsRequest {
  string service_name = 1;
  string tenant_id = 2;
  string start_time = 3;
  string end_time = 4;
}

// CollectMetricsResponse содержит результат сбора метрик
message CollectMetricsResponse {
  bool success = 1;
  int32 metrics_count = 2;
  string collected_at = 3;
}

// ExportMetricsRequest содержит параметры экспорта метрик
message ExportMetricsRequest {
  string format = 1; // "prometheus", "json", "csv"
  string service_name = 2;
  string tenant_id = 3;
}

// ExportMetricsResponse содержит экспортированные метрики
message ExportMetricsResponse {
  bytes data = 1;
  string content_type = 2;
  int32 chunk_number = 3;
}

// GetMetricsRequest содержит параметры для получения метрик
message GetMetricsRequest {
  repeated string metric_names = 1;
  string service_name = 2;
  string tenant_id = 3;
  string start_time = 4;
  string end_time = 5;
}

// GetMetricsResponse содержит текущие значения метрик
message GetMetricsResponse {
  map<string, MetricValue> metrics = 1;
}

// MetricValue представляет значение метрики
message MetricValue {
  double value = 1;
  string timestamp = 2;
  map<string, string> labels = 3;
}